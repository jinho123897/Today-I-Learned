# 객체를 원시형으로 변환하기
`obj1 + obj2`처럼 객체끼리 더하는 연산을 하거나, `obj1 - obj2`처럼 객체끼리 빼는 연산을 하면 어떤 일이 일어날까요? `alert(obj)`로 객체를 출력할 때는 무슨 일이 발생할까요?   
   
이 모든 경우에 자동 형 변환이 일어납니다. 객체는 원시값으로 변환되고, 그 후 의도한 연산이 수행됩니다.   

1. 객체는 논리 평가시 `true`를 반환합니다. 단 하나의 예외도 없죠. 따라서 객체는 숫자형이나 문자형으로만 형 변환이 일어난다고 생각하시면 됩니다.
2. 숫자형으로의 형 변환은 객체끼리 빼는 연산을 할 때나 수학 관련 함수를 적용할 때 일어납니다. 객체 `Date`끼리 차감하면(`date1 - date2`) 두 날짜의 시간 차이가 반환됩니다.
3. 문자형으로의 형 변환은 대개 `alert(obj)`같이 객체를 출력하려고 할 때 일어납니다.


## ToPrimitive
특수 객체 메서드를 사용하면 숫자형이나 문자형으로의 형 변환을 원하는 대로 조절할 수 있습니다.   
   
객체 형 변환은 세 종류로 구분되는데, 'hint'라 불리는 값이 구분 기준이 됩니다. 'hint'가 무엇인지는 명세서에 설명되어 있는데, '목표로 하는 자료형' 정도로 이해하시면 될 것 같습니다.   
   
`"string"`   
`alert` 함수 같이 문자열을 기대하는 연산을 수행할 때는(객체-문자형 변환), hint가 `string`이 됩니다.
```
// 객체를 출력하려고 함
alert(obj);

// 객체를 프로퍼티 키로 사용하고 있음
anotherObj[obj] = 123;
```
   
`"number"`   
수학 연산을 적용하려 할 때(객체-숫자형 변환), hint는 `number`가 됩니다.
```
let num = Number(obj);

// (이항 덧셈 연산을 제외한) 수학 연산
let n = +obj;  // 단항 덧셈 연산
let delta = date1 - date2;

// 크고 작음 비교하기
let greater = user1 > user2;
```
   
`"default"`   
연산자가 기대하는 자료형이 '확실치 않을 때' hint는 `default`가 됩니다. 아주 드물게 발생합니다.   
   
이항 덧셈 연산자는 피연산자의 자료형에 따라 문자열을 합치는 연산을 할 수도 있고 숫자를 더해주는 연산을 할 수도 있습니다. 따라나 `+`의 인수가 객체일 때는 hint가 `default`가 됩니다.   
   
동등 연산자 `==`를 사용해 객체-문자형, 객체-숫자형, 객체-심볼형끼리 비교할 때도, 객체를 어떤 자료형으로 바꿔야 할지 확신이 안서므로 hint는 default가 됩니다.   
```
// 이항 덧셈 연산은 hint로 'default'를 사용합니다.
let total = obj1 + obj2;

// obj == number 연산은 hint로 'default'를 사용합니다.
if(user == 1) { ... };
```
크고 작음을 비교할 때 쓰이는 연산자 `<`, `>`역시 피연산자에 문자형과 숫자형 둘 다를 허용하는데, 이 연산자들은 hint를 'number'로 고정합니다. hint가 'default'가 되는 일이 없죠. 이는 하위 호환성 때문에 정행진 규칙입니다.   
   
실제 일을 할때는 이런 사항을 모두 외울 필요는 없습니다. `Date` 객체를 제외한 모든 내장 객체는 hint가 `"default"`인 경우와 `"number"`인 경우를 동일하게 처리하기 때문입니다. 우리도 커스텀 객체를 만들 땐 이런 규칙을 따르면 됩니다.   
   
❕`"boolean"` hint는 없습니다.   
   
hint는 총 세가지입니다. 아주 간단하죠.   
'boolean' hint는 존재하지 않습니다. 모든 객체는 그냥 `true`로 평가됩니다. 게다가 우리도 내장 객체에 사용되는 규칙처럼 `"defaul"`와 `"number"`를 동일하게 처리하면, 결국엔 두 종류의 형 변환(객체-문자형, 객체-숫자형)만 남게 됩니다.   
   
자바스크립트는 형 변환이 필요할 때, 아래와 같은 알고리즘에 따라 원하는 메서드를 찾고 호출합니다.
1. 객체에 `obj[Symbol.toPrimitive](hint)`메서드가 있는지 찾고, 있다면 메서드를 호출합니다. `Symbol.toPrimitive`는 시스템 심볼로, 심볼형 키로 사용됩니다.
2. 1에 해당하지 않고 hint가 `"string"`이라면,
- `obj.toString()`이나 `obj.valueOf()`를 호출합니다.(존재하는 메서드만 실행됨)
3. 1과 2에 해당하지 않고, hint가 `"number"`나 `"default"`라면
- `obj.valueOf()`나 `obj.toString()`을 호출합니다(존재하는 메서드만 실행됨)
